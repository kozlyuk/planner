{% extends 'main.html' %}
{% block 'row1' %}
{% load ita_template_tags %}
{% load static %}
<link href="{% static 'assets/global/css/custom.css' %}" rel="stylesheet" type="text/css"/>
<!-- BEGIN CONTAINER -->
<div class="row">
    <div class="col-xl-5 col-lg-6 col-md-6 margin-bottom-20">
        <!-- BEGIN WIDGET TAB -->
        <div class="widget-bg-color-white widget-tab main-widget-tab">
            <h6 class="task-header center-block text-center"><i class="fas fa-tasks"></i> Проекти</h6>
            <ul class="nav nav-pills nav-tabs pt-2" id="pills-tab" role="tablist">
                <li class="nav-item">
                    <a class="nav-link" id="pills-tab_1_1-tab" data-toggle="pill" href="#tab_1_1" role="tab"
                        aria-controls="pills-tab_1_1" aria-selected="false"> В черзі
                        {% if td_executions_count != 0 %}
                            <span class="badge badge-pill badge-warning">  {{ td_executions_count }} </span>
                        {% endif %}
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link active" id="pills-tab_1_2-tab" data-toggle="pill" href="#tab_1_2" role="tab"
                        aria-controls="pills-tab_1_2" aria-selected="true"> Виконуються
                        {% if ip_executions_count != 0 %}
                            <span class="badge badge-pill badge-danger">  {{ ip_executions_count }} </span>
                        {% endif %}
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="pills-tab_1_3-tab" data-toggle="pill" href="#tab_1_3" role="tab"
                        aria-controls="pills-tab_1_3" aria-selected="false"> На перевірці
                        {% if oc_executions_count != 0 %}
                            <span class="badge badge-pill badge-primary">  {{ oc_executions_count }} </span>
                        {% endif %}
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="pills-tab_1_4-tab" data-toggle="pill" href="#tab_1_4" role="tab"
                        aria-controls="pills-tab_1_4" aria-selected="false"> Виконано
                        {% if hd_executions_count != 0 %}
                            <span class="badge badge-pill badge-success">  {{ hd_executions_count }} </span>
                        {% endif %}
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="pills-tab_1_5-tab" data-toggle="pill" href="#tab_1_5" role="tab"
                        aria-controls="pills-tab_1_5" aria-selected="false"> Завдання
                        {% if sent_tasks_count != 0 %}
                            <span class="badge badge-pill badge-info"> {{ active_inttasks_count }} </span>
                        {% endif %}
                    </a>
                </li>
            </ul>
            <div style="height: 355px" class="tab-content scroller pt-1" id="pills-tabContent">
                <div class="tab-pane fade" id="tab_1_1" role="tabpanel" aria-labelledby="pills-tab_1_1">
                    {% for execution in td_executions %}
                    <div class="widget-news margin-bottom-10">
                        <div class="widget-news-right-body">
                            <h3 class="widget-news-right-body-title">
                                <a href="{% url 'subtask_detail' execution.pk %}">{{ execution.task.object_code }}
                                    {{ execution.task.object_address|slice:":75" }}</a>
                                <span
                                    class="badge badge-pill badge-{% task_overdue_color execution.task.warning %} float-right">
                                    {{ execution.task.warning }} </span>
                            </h3>
                            <span class="badge badge-pill badge-secondary">{{ execution.subtask.name }}</span>
                            {{ execution.task.project_type }}
                        </div>
                    </div>
                    {% endfor %}
                </div>
                <div class="tab-pane fade show active" id="tab_1_2" role="tabpanel" aria-labelledby="pills-tab_1_2">
                    {% for execution in ip_executions %}
                    <div class="widget-news margin-bottom-10">
                        <div class="widget-news-right-body">
                            <h3 class="widget-news-right-body-title">
                                <a href="{% url 'subtask_detail' execution.pk %}">{{ execution.task.object_code }}
                                    {{ execution.task.object_address|slice:":75" }}</a>
                                <span
                                    class="badge badge-pill badge-{% task_overdue_color execution.task.warning %} float-right">
                                    {{ execution.task.warning }} </span>
                            </h3>
                            <span class="badge badge-pill badge-secondary">{{ execution.subtask.name }}</span>
                            {{ execution.task.project_type }}
                        </div>
                    </div>
                    {% endfor %}
                </div>
                <div class="tab-pane fade" id="tab_1_3" role="tabpanel" aria-labelledby="pills-tab_1_3">
                    {% for execution in oc_executions %}
                    <div class="widget-news margin-bottom-10">
                        <div class="widget-news-right-body">
                            <h3 class="widget-news-right-body-title">
                                <a href="{% url 'subtask_detail' execution.pk %}">{{ execution.task.object_code }}
                                    {{ execution.task.object_address|slice:":75" }}</a>
                                <span
                                    class="badge badge-pill badge-{% task_overdue_color execution.task.warning %} float-right">
                                    {{ execution.task.warning }} </span>
                            </h3>
                            <span class="badge badge-pill badge-secondary">{{ execution.subtask.name }}</span>
                            {{ execution.task.project_type }}
                        </div>
                    </div>
                    {% endfor %}
                </div>
                <div class="tab-pane fade" id="tab_1_4" role="tabpanel" aria-labelledby="pills-tab_1_4">
                    {% for execution in hd_executions %}
                    <div class="widget-news margin-bottom-10">
                        <div class="widget-news-right-body">
                            <h3 class="widget-news-right-body-title">
                                <a href="{% url 'subtask_detail' execution.pk %}">{{ execution.task.object_code }}
                                    {{ execution.task.object_address|slice:":75" }}</a>
                                <span
                                    class="badge badge-pill badge-{% task_overdue_color execution.task.warning %} float-right">
                                    {{ execution.task.warning }} </span>
                            </h3>
                            <span class="badge badge-pill badge-secondary">{{ execution.subtask.name }}</span>
                            {{ execution.task.project_type }}
                        </div>
                    </div>
                    {% endfor %}
                </div>
                <div class="tab-pane fade" id="tab_1_5" role="tabpanel" aria-labelledby="pills-tab_1_5">
                    {% for inttask in inttasks %}
                    <div class="widget-news margin-bottom-10">
                        <div class="widget-news-right-body">
                            <h3 class="widget-news-right-body-title">
                            <a href="{% url 'inttask_detail' inttask.id %}">{{ inttask.task_name }}</a>
                                <span
                                class="badge badge-pill badge-{% task_overdue_color inttask.get_exec_status_display %} float-right">
                                {{ inttask.get_exec_status_display }} </span>
                            </h3>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
        <!-- END WIDGET TAB -->
    </div>

    <div class="col-xl-3 col-lg-6 col-md-6 col-sm-12 col-12 margin-bottom-20">
        <h6 style="margin-top: -8px;" class="task-header center-block text-center"><i style="font-size: 12px;" class="far fa-star"></i> Рейтинг проектувальників</h6>
        <!-- BEGIN WIDGET TAB -->
        <div class="portlet light  widget-bg-color-white widget-tab main-widget-tab">
            <div class="portlet-body">
                <div class="scroller" style="height: 365px;" data-always-visible="1" data-rail-visible="0">
                    <ul class="feeds">
                        {% for rating in executors_rating %}
                        <li style="width: 100%;">
                            <div class="col1">
                                <div class="cont">
                                    <div class="cont-col1">
                                        <div class="label label-sm label-success">
                                            <i class="fa fa-user"></i>
                                        </div>
                                    </div>
                                    <div class="cont-col2">
                                        <div class="desc">
                                            {{ rating.employee.name }}
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col2">
                                {% if rating.value < 80 %}
                                <div class="badge badge-pill badge-warning"> {{ rating.value }} </div>
                                {% else %}
                                <div class="badge badge-pill badge-success"> {{ rating.value }} </div>
                                {% endif %}
                            </div>
                        </li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
        </div>
        <!-- END WIDGET TAB -->
    </div>

    <div class="col-xl-2 col-lg-6 col-sm-12 margin-bottom-20">
        <!-- BEGIN WIDGET THUMB -->
        <div class="col-12 pl-0 pr-0 mb-3">
            <!-- BEGIN WIDGET THUMB -->
            <div class="widget-thumb widget-bg-color-white margin-bottom-4 pt-3 pb-3">
                <div class="widget-thumb-wrap">
                    <i class="widget-thumb-icon bg-red icon-layers"></i>
                    <p class="mb-0">Виконання проектів</p>
                    <div class="widget-thumb-body">
                        <span style="float: left; font-size: 22px"
                            class="widget-thumb-body-stat"
                            data-counter="counterup"
                            data-value="{{ bonus }}">0</span>
                    </div>
                </div>
            </div>
            <!-- END WIDGET THUMB -->
        </div>
        <div class="col-12 pl-0 pr-0 mb-3">
            <!-- BEGIN WIDGET THUMB -->
            <div class="widget-thumb widget-bg-color-white margin-bottom-4 pt-3 pb-3">
                <div class="widget-thumb-wrap">
                    <i class="widget-thumb-icon bg-green icon-layers mt-1"></i>
                    <p class="mb-0">Виконання завдань</p>
                    <div class="widget-thumb-body">
                        <span style="float: left; font-size: 22px"
                            class="widget-thumb-body-stat"
                            data-counter="counterup"
                            data-value="{{ inttask_bonus }}">0</span>
                    </div>
                </div>
            </div>
            <!-- END WIDGET THUMB -->
        </div>
        <div class="col-12 pl-0 pr-0 mb-3">
            <!-- BEGIN WIDGET THUMB -->
            <div class="widget-thumb widget-bg-color-white margin-bottom-4 pt-3 pb-3">
                <div class="widget-thumb-wrap">
                    <i class="widget-thumb-icon bg-blue icon-bulb"></i>
                    <p class="mb-0">Бонуси сумарно</p>
                    <div class="widget-thumb-body">
                        <a href={% url 'bonus_calc' employee_id current_year current_month %}>
                            <span style="float: left; font-size: 22px"
                            class="widget-thumb-body-stat"
                            data-counter="counterup"
                            data-value="{{ total_bonus }}">0</span></a>
                    </div>
                </div>
            </div>
            <!-- END WIDGET THUMB -->
        </div>
    </div>
    <div class="col-xl-2 col-lg-6 col-sm-12 margin-bottom-20">
        <div class="col">
            <div class="widget-progress">
                <div class="widget-progress-element widget-bg-color-blue margin-bottom-25">
                    <span class="widget-progress-title">Виконано проектів
                        <span class="pull-right">{{ hd_executions_count }}/{{ active_executions_count }}</span>
                    </span>
                    <div class="progress">
                        <div class="progress-bar bg-light"
                            role="progressbar"
                            style="width: {{ executions_div }}%">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col">
            <div class="widget-progress">
                <div class="widget-progress-element widget-bg-color-red margin-bottom-25">
                    <span class="widget-progress-title">Протерміновано проектів
                        <span class="pull-right">{{ overdue_executions_count }}/{{ active_executions_count }}</span>
                    </span>
                    <div class="progress">
                        <div class="progress-bar bg-light"
                            role="progressbar"
                            style="width: {{ overdue_executions_div }}%">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col">
            <div class="widget-progress">
                <div class="widget-progress-element widget-bg-color-green  margin-bottom-25">
                    <span class="widget-progress-title">Продуктивність
                        <span class="pull-right">{{ productivity }}%</span>
                    </span>
                    <div class="progress">
                        <div class="progress-bar bg-light"
                            role="progressbar"
                            style="width: {{ productivity }}%">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col">
            <div class="widget-progress">
                <div class="widget-progress-element widget-bg-color-purple">
                    <span class="widget-progress-title">Протерміновано завдань
                        <span class="pull-right">{{ overdue_inttasks_count }}/{{ active_inttasks_count }}</span>
                    </span>
                    <div class="progress">
                        <div class="progress-bar bg-light"
                            role="progressbar"
                            style="width: {{ overdue_inttasks_div }}%">
                        </div>
                    </div>
                </div>
            </div>
            <!-- END WIDGET PROGRESS -->
        </div>
    </div>
</div>
<!-- END CONTAINER -->
{% endblock %}
